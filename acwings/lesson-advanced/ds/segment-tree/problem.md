### 1275. 最大数

给定一个正整数数列a1,a2,…,an，每一个数都在 0∼p−1 之间。

可以对这列数进行两种操作：

1. 添加操作：向序列后添加一个数，序列长度变成 n+1；
2. 询问操作：询问这个序列中最后 L 个数中最大的数是多少。

程序运行的最开始，整数序列为空。

一共要对整数序列进行 m 次操作。

写一个程序，读入操作的序列，并输出询问操作的答案。

#### 输入格式

第一行有两个正整数 m,p，意义如题目描述；

接下来 m 行，每一行表示一个操作。

如果该行的内容是 `Q L`，则表示这个操作是询问序列中最后 L 个数的最大数是多少；

如果是 `A t`，则表示向序列后面加一个数，加入的数是 (t+a) mod p。其中，t 是输入的参数，a 是在这个添加操作之前最后一个询问操作的答案（如果之前没有询问操作，则 a=0）。

第一个操作一定是添加操作。对于询问操作，L>0 且不超过当前序列的长度。

#### 输出格式

对于每一个询问操作，输出一行。该行只有一个数，即序列中最后 L 个数的最大数。

#### 数据范围

1≤m≤2×10^5,
1≤p≤2×10^9,
0≤t<p

#### 输入样例：

```
10 100
A 97
Q 1
Q 1
A 17
Q 2
A 63
Q 1
Q 1
Q 3
A 99
-----
4 1999999999
A 1999999998
Q 1
A 1999999998
Q 1
```

#### 输出样例：

```
97
97
97
60
60
97
-----
1999999998
1999999997
```

#### 样例解释

最后的序列是 97,14,60,96。


### 1277. 维护序列

老师交给小可可一个维护数列的任务，现在小可可希望你来帮他完成。

有长为 **N**N 的数列，不妨设为 a1,a2,…,aN。

有如下三种操作形式：

1. 把数列中的一段数全部乘一个值；
2. 把数列中的一段数全部加一个值；
3. 询问数列中的一段数的和，由于答案可能很大，你只需输出这个数模 P 的值。

#### 输入格式

第一行两个整数 N 和 P；

第二行含有 N 个非负整数，从左到右依次为 a1,a2,…,aN；

第三行有一个整数 M，表示操作总数；

从第四行开始每行描述一个操作，输入的操作有以下三种形式：

* 操作 1：`1 t g c`，表示把所有满足 **t**≤**i**≤**g** 的 ai 改为 ai × c；
* 操作 2：`2 t g c`，表示把所有满足 **t**≤**i**≤**g** 的 ai 改为 ai + c；
* 操作 3：`3 t g`，询问所有满足 **t**≤**i**≤**g** 的 ai 的和模 P 的值。

同一行相邻两数之间用一个空格隔开，每行开头和末尾没有多余空格。

#### 输出格式

对每个操作 3，按照它在输入中出现的顺序，依次输出一行一个整数表示询问结果。

#### 数据范围

1≤N,M≤10^5,
**1≤t≤g≤N,**
0≤c,ai≤10^9,
1≤P≤10^9

#### 输入样例：

```
7 43
1 2 3 4 5 6 7
5
1 2 5 5
3 2 4
2 3 7 9
3 1 3
3 4 7
```

#### 输出样例：

```
2
35
8
```

#### 样例解释

初始时数列为 {1,2,3,4,5,6,7}；

经过第 1 次操作后，数列为 {1,10,15,20,25,6,7}；

对第 2 次操作，和为 10+15+20=45，模 43 的结果是 2；

经过第 3 次操作后，数列为 {1,10,24,29,34,15,16}；

对第 4 次操作，和为 1+10+24=35，模 43 的结果是 35；

对第 5 次操作，和为 29+34+15+16=94，模 43 的结果是 8。
